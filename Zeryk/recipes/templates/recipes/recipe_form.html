{% extends "recipes/box.html" %}
{% load i18n %}
{% load crispy_forms_tags %}
{% block content %}
<div class="container">
  <form method="POST" enctype="multipart/form-data">
    <fieldset class="form-group">
      <legend class="border-bottom mb-4">{% trans "Add Recipe" %}</legend>
    </fieldset>

    <img id="photo-prev" src="#" alt="Recipe Photo" style="display: none; max-width: 600px; max-height: fit-content;"/>
    
    {% csrf_token %}
    {{ form.media }}
    {{ form.as_p }}

    {% if object.ingredients.all|length %}
    <h6>{% trans "Ingredients:" %}</h6>
    <div class="ingredients">
      {% for ingredient in object.ingredients.all %}
      <div class="ingredient">{{ ingredient.name }}</div>
      {% endfor %}
    </div>
  {% else %}
    <p></p>
  {% endif %}
  </div>
  <div class="form-group py-3">
    <input class="btn btn-outline-primary" type="submit" value="{% trans "Save Recipe" %}" />
  </div>

  <div class="border-top pt-3">
    <a class="text-muted" href="{% url 'recipes-home' %}">{% trans "Cancel" %}</a>
  </div>
</div>

<script>
  document.getElementById('photo').addEventListener('change', function(event) {
    var output = document.getElementById('photo-prev');
    output.style.display = 'block';
    output.src = URL.createObjectURL(event.target.files[0]);
  });
</script>
{% endblock content %}